@import "tailwindcss";

/* ==================== 优化后的变量定义 ==================== */
:root {
  /* 主题变量 */
  --bg-waibi: #040404;         /* 外壁模式背景色，暗黑色调 */
  --bg-rational: #f5f5f5;      /* 理性模式背景色，浅灰色 */
  --fg-waibi: #f6f7ff;         /* 外壁模式前景色，浅灰蓝色 */
  --fg-rational: #111111;      /* 理性模式前景色，深灰色 */

  /* 强调色 */
  --accent-cyan: #12cd31;      /* 突出显示的青色 */
  --accent-purple: #b179ff;    /* 突出显示的紫色 */
  --accent-green: #8bff4e;     /* 突出显示的绿色 */

  /* 噪点效果 */
  --noise-opacity: 0.1;        /* 噪点层的透明度 */

  /* 字体栈 */
  --pixel-font: 'Press Start 2P'; /* 像素风格字体 */
  --font-sans-cn: 'ZCOOLXiaoWei'; /* 中文字体 */
  --body-font: var(--font-sans-cn), var(--pixel-font); /* 全局字体栈：中文字体优先，英文字体其次，默认使用 monospace 字体 */

  color-scheme: dark light;   /* 设置支持的颜色模式：暗黑和明亮 */
}


/* ==================== 字体加载优化 ==================== */
@font-face {
  font-family: 'Press Start 2P';               /* 定义字体名称 */
  src: url('/fonts/PressStart2P-Regular.ttf') format('truetype'); /* 引入字体文件 */
  unicode-range: U+0000-00FF;                  /* 只加载拉丁字符 */
  font-display: swap;                          /* 字体加载时，使用系统字体直到字体加载完成 */
}

@font-face {
  font-family: 'ZCOOLXiaoWei';                /* 定义中文字体 */
  src: url('/fonts/ZCOOLXiaoWei-Regular.ttf') format('truetype'); /* 引入中文字体文件 */
  font-display: swap;                         /* 字体加载时，使用系统字体直到字体加载完成 */
}



/* ==================== 全局样式优化 ==================== */
html {
  background-color: var(--bg-waibi); /* 默认为外壁模式背景 */
  color: var(--fg-waibi);            /* 默认为外壁模式前景色 */
  font-size: 18px;                   /* 设置基础字体大小 */
  scroll-behavior: smooth;           /* 平滑滚动效果 */

  /* 理性模式 */
  &[data-mode="rational"] {
    background-color: var(--bg-rational); /* 切换到理性模式背景 */
    color: var(--fg-rational);            /* 切换到理性模式前景色 */
  }
}

body {
  font-family: var(--body-font), sans-serif; /* 默认字体栈，中文字体优先，英文字体为后备 */
  margin: 0;                             /* 去除页面默认边距 */
  min-height: 100vh;                     /* 设置页面最小高度为 100% 视口高度 */
  background-color: inherit;             /* 背景色继承 */
  color: inherit;                        /* 文字颜色继承 */
  font-family: var(--body-font), fangsong; /* 全局使用中文字体，英文字体为后备 */
}

body:lang(zh) {
  font-family: var(--font-sans-cn), var(--pixel-font), sans-serif; /* 中文字体优先 */
}

body:lang(en) {
  font-family: var(--pixel-font), sans-serif; /* 英文字体优先 */
}

html[data-mode="waibi"] & {
  background-image:
          radial-gradient(circle at 20% 20%, rgba(21, 243, 255, 0.12), transparent 45%),
          radial-gradient(circle at 80% 0%, rgba(177, 121, 255, 0.08), transparent 40%);
}

/* ==================== 字体设置优化 ==================== */
* {
  box-sizing: border-box; /* 包括 padding 和 border 在内的总宽度和高度计算方式 */
}

a {
  color: inherit;         /* 链接颜色继承父元素的颜色 */
  text-decoration: none;  /* 去除链接的下划线 */

  &:focus-visible,
  button:focus-visible {
    outline: 2px solid var(--accent-cyan); /* 聚焦时显示轮廓 */
    outline-offset: 3px;
  }
}

button {
  cursor: pointer; /* 鼠标悬停时显示指针 */
}


/* ==================== 布局优化 ==================== */
main {
  width: min(94vw);
  margin-inline: auto;
  padding-block: clamp(3rem, 4vw, 4rem);

  @media (max-width: 768px) {
    width: min(640px, 92vw);
    padding-block: 2.5rem;
  }
}


/* ==================== 文本样式优化 ==================== */
.pixel-text,
h1, h2, h3, h4, h5, h6 {
  font-family: var(--pixel-font), fangsong; /* 像素字体风格用于标题 */
  letter-spacing: 0.08em;                    /* 字母间距 */
}

.accent-text {
  html[data-mode="waibi"] & {
    color: var(--accent-cyan); /* 外壁模式下使用强调色 */
  }

  html[data-mode="rational"] & {
    color: var(--fg-rational); /* 理性模式下使用前景色 */
  }
}


/* ==================== 动画效果优化 ==================== */
/* 故障效果 */
html[data-motion="wild"] .glitch-hover:hover {
  animation: glitch 120ms steps(2, jump-none) 1;
}

@keyframes glitch {
  0% { transform: translate3d(-1px,0,0); filter: hue-rotate(10deg); }
  50% { transform: translate3d(1px,0,0); filter: hue-rotate(-10deg); }
  100% { transform: translate3d(0,0,0); filter: none; }
}

/* 浮动效果 */
html[data-motion="wild"] .entry-hero {
  animation: drift 6s infinite ease-in-out alternate;
}

@keyframes drift {
  0% { filter: drop-shadow(0 0 6px rgba(21,243,255,0.3)); }
  100% { filter: drop-shadow(0 0 10px rgba(177,121,255,0.4)); }
}


/* 页面过渡 */
.page-transitioning main {
  animation: page-blip 260ms ease-in;
}

@keyframes page-blip {
  0% { opacity: 0.6; transform: translateY(4px) scaleX(1.02); }
  50% { opacity: 1; transform: translateY(-2px) scaleX(0.99); }
  100% { opacity: 1; transform: none; }
}


/* ==================== 视觉效果优化 ==================== */
/* 噪点层 */
.noise-layer {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.35'/%3E%3C/svg%3E");
  mix-blend-mode: screen;
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: 5;

  html[data-mode="waibi"] & {
    opacity: var(--noise-opacity);
  }

  html[data-motion="calm"] & {
    opacity: 0.02;
  }
}


/* CRT滤镜 */
.crt-filter {
  position: relative;

  &::after {
    content: "";
    position: absolute;
    inset: 0;
    mix-blend-mode: soft-light;
    background:
            repeating-linear-gradient(0deg, rgba(255,255,255,0.08), rgba(255,255,255,0.08) 1px, transparent 1px, transparent 2px),
            repeating-linear-gradient(90deg, rgba(21,243,255,0.05), rgba(177,121,255,0.05) 2px, transparent 2px, transparent 4px);
    opacity: 0;
    transition: opacity 0.4s ease;
    pointer-events: none;
  }

  html[data-mode="waibi"] &::after { opacity: 0.4; }
  html[data-motion="calm"] &::after { opacity: 0.1; }
}

/* 打字机效果 */
@keyframes typing {
  0% {
    width: 0;
  }
  100% {
    width: 100%;
  }
}

.typewriter {
  overflow: hidden;
  white-space: nowrap;
  width: 0;
  animation: typing 3s steps(30) 1s forwards, blink-caret 0.75s step-end infinite;
}

@keyframes blink-caret {
  50% {
    border-color: transparent;
  }
}


/* ==================== 动画降级处理 ==================== */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .glitch-hover:hover,
  .entry-hero,
  .page-transitioning main {
    animation: none !important;
  }
}